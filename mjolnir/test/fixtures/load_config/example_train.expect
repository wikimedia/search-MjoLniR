global_config:
  commands:
    data_pipeline:
      cmd_args:
        input: hdfs://analytics-hadoop/wmf/data/discovery/query_clicks/daily/year=*/month=*/day=*
        min-sessions: '10'
        output-dir: hdfs://analytics-hadoop/user/pytest/mjolnir/marker
        samples-per-wiki: '35000000'
        search-cluster: codfw
      environment:
        HOME: /home/pytest
        PYSPARK_PYTHON: venv/bin/python
        SPARK_CONF_DIR: /etc/spark2/conf
        SPARK_HOME: /usr/lib/spark2
        USER: pytest
      mjolnir_utility: data_pipeline
      mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
      paths:
        dir_exist: !!set
          /etc/spark2/conf: null
        dir_not_exist: !!set
          /mnt/hdfs/user/pytest/mjolnir/marker: null
        file_exist: !!set
          /srv/mjolnir/mjolnir_venv.zip: null
          /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
          /usr/lib/spark2/bin/spark-submit: null
          venv/bin/python: null
      spark_args:
        archives: /srv/mjolnir/mjolnir_venv.zip#venv
        executor-cores: '1'
        executor-memory: 2G
        files: /usr/lib/libhdfs.so.0.0.0
        master: yarn
        packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
        repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
      spark_command: /usr/lib/spark2/bin/spark-submit
      spark_conf:
        spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
          -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
        spark.task.cpus: '1'
        spark.yarn.executor.memoryOverhead: '512'
    make_folds:
      cmd_args:
        input: hdfs://analytics-hadoop/user/pytest/mjolnir/marker
        max-executors: '50'
        num-folds: '5'
        num-workers: '1'
        output-dir: hdfs://analytics-hadoop/user/pytest/mjolnir/marker-folds_global
      environment:
        HOME: /home/pytest
        PYSPARK_PYTHON: venv/bin/python
        SPARK_CONF_DIR: /etc/spark2/conf
        SPARK_HOME: /usr/lib/spark2
        USER: pytest
      mjolnir_utility: make_folds
      mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
      paths:
        dir_exist: !!set
          /etc/spark2/conf: null
        file_exist: !!set
          /srv/mjolnir/mjolnir_venv.zip: null
          /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
          /usr/lib/spark2/bin/spark-submit: null
          venv/bin/python: null
      spark_args:
        archives: /srv/mjolnir/mjolnir_venv.zip#venv
        executor-cores: '1'
        executor-memory: 2G
        files: /usr/lib/libhdfs.so.0.0.0
        master: yarn
        packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
        repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
      spark_command: /usr/lib/spark2/bin/spark-submit
      spark_conf:
        spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
          -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
        spark.dynamicAllocation.maxExecutors: '100'
        spark.locality.wait: '0'
        spark.task.cpus: '1'
        spark.yarn.executor.memoryOverhead: '512'
    pyspark:
      environment:
        HOME: /home/pytest
        PYSPARK_PYTHON: venv/bin/python
        SPARK_CONF_DIR: /etc/spark2/conf
        SPARK_HOME: /usr/lib/spark2
        USER: pytest
      paths:
        dir_exist: !!set
          /etc/spark2/conf: null
        file_exist: !!set
          /srv/mjolnir/mjolnir_venv.zip: null
          /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
          /usr/lib/spark2/bin/spark-submit: null
          venv/bin/python: null
      spark_args:
        archives: /srv/mjolnir/mjolnir_venv.zip#venv
        executor-cores: '1'
        executor-memory: 2G
        files: /usr/lib/libhdfs.so.0.0.0
        master: yarn
        packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
        repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
      spark_command: /usr/lib/spark2/bin/pyspark
      spark_conf:
        spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
          -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
        spark.task.cpus: '1'
        spark.yarn.executor.memoryOverhead: '512'
    pyspark_train:
      environment:
        HOME: /home/pytest
        PYSPARK_PYTHON: venv/bin/python
        SPARK_CONF_DIR: /etc/spark2/conf
        SPARK_HOME: /usr/lib/spark2
        USER: pytest
      paths:
        dir_exist: !!set
          /etc/spark2/conf: null
        file_exist: !!set
          /srv/mjolnir/mjolnir_venv.zip: null
          /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
          /usr/lib/spark2/bin/spark-submit: null
          venv/bin/python: null
      spark_args:
        archives: /srv/mjolnir/mjolnir_venv.zip#venv
        executor-cores: '4'
        executor-memory: 2G
        files: /usr/lib/libhdfs.so.0.0.0
        master: yarn
        packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
        repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
      spark_command: /usr/lib/spark2/bin/pyspark
      spark_conf:
        spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
          -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
        spark.task.cpus: '4'
        spark.yarn.executor.memoryOverhead: '6144'
    training_pipeline:
      cmd_args:
        input: hdfs://analytics-hadoop/user/pytest/mjolnir/marker-folds_global
        output: /home/pytest/training_size/marker-folds_global
      environment:
        HOME: /home/pytest
        PYSPARK_PYTHON: venv/bin/python
        SPARK_CONF_DIR: /etc/spark2/conf
        SPARK_HOME: /usr/lib/spark2
        USER: pytest
      mjolnir_utility: training_pipeline
      mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
      paths:
        dir_exist: !!set
          /etc/spark2/conf: null
          /home/pytest/training_size: null
        file_exist: !!set
          /srv/mjolnir/mjolnir_venv.zip: null
          /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
          /usr/lib/spark2/bin/spark-submit: null
          venv/bin/python: null
      spark_args:
        archives: /srv/mjolnir/mjolnir_venv.zip#venv
        driver-memory: 3G
        executor-cores: '1'
        executor-memory: 2G
        files: /usr/lib/libhdfs.so.0.0.0
        master: yarn
        packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
        repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
      spark_command: /usr/lib/spark2/bin/spark-submit
      spark_conf:
        spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
          -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
        spark.dynamicAllocation.executorIdleTimeout: 180s
        spark.task.cpus: '1'
        spark.yarn.executor.memoryOverhead: '512'
  wikis: []
profiles:
  large:
    commands:
      data_pipeline:
        cmd_args:
          input: hdfs://analytics-hadoop/wmf/data/discovery/query_clicks/daily/year=*/month=*/day=*
          min-sessions: '10'
          output-dir: hdfs://analytics-hadoop/user/pytest/mjolnir/marker
          samples-per-wiki: '35000000'
          search-cluster: codfw
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        mjolnir_utility: data_pipeline
        mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          dir_not_exist: !!set
            /mnt/hdfs/user/pytest/mjolnir/marker: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '1'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/spark-submit
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.task.cpus: '1'
          spark.yarn.executor.memoryOverhead: '512'
      make_folds:
        cmd_args:
          input: hdfs://analytics-hadoop/user/pytest/mjolnir/marker
          max-executors: '50'
          num-folds: '3'
          num-workers: '1'
          output-dir: hdfs://analytics-hadoop/user/pytest/mjolnir/marker-folds_large
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        mjolnir_utility: make_folds
        mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '1'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/spark-submit
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.dynamicAllocation.maxExecutors: '100'
          spark.locality.wait: '0'
          spark.task.cpus: '1'
          spark.yarn.executor.memoryOverhead: '5120'
      pyspark:
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '1'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/pyspark
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.task.cpus: '1'
          spark.yarn.executor.memoryOverhead: '512'
      pyspark_train:
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '4'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/pyspark
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.task.cpus: '4'
          spark.yarn.executor.memoryOverhead: '6144'
      training_pipeline:
        cmd_args:
          cv-jobs: '80'
          final-trees: '100'
          input: hdfs://analytics-hadoop/user/pytest/mjolnir/marker-folds_large
          output: /home/pytest/training_size/marker-folds_large
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        mjolnir_utility: training_pipeline
        mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
            /home/pytest/training_size: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          driver-memory: 3G
          executor-cores: '6'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/spark-submit
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.dynamicAllocation.executorIdleTimeout: 180s
          spark.dynamicAllocation.maxExecutors: '85'
          spark.task.cpus: '6'
          spark.yarn.executor.memoryOverhead: '6144'
    wikis:
    - enwiki
    - dewiki
  medium:
    commands:
      data_pipeline:
        cmd_args:
          input: hdfs://analytics-hadoop/wmf/data/discovery/query_clicks/daily/year=*/month=*/day=*
          min-sessions: '10'
          output-dir: hdfs://analytics-hadoop/user/pytest/mjolnir/marker
          samples-per-wiki: '35000000'
          search-cluster: codfw
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        mjolnir_utility: data_pipeline
        mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          dir_not_exist: !!set
            /mnt/hdfs/user/pytest/mjolnir/marker: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '1'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/spark-submit
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.task.cpus: '1'
          spark.yarn.executor.memoryOverhead: '512'
      make_folds:
        cmd_args:
          input: hdfs://analytics-hadoop/user/pytest/mjolnir/marker
          max-executors: '50'
          num-folds: '5'
          num-workers: '1'
          output-dir: hdfs://analytics-hadoop/user/pytest/mjolnir/marker-folds_medium
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        mjolnir_utility: make_folds
        mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '1'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/spark-submit
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.dynamicAllocation.maxExecutors: '100'
          spark.locality.wait: '0'
          spark.task.cpus: '1'
          spark.yarn.executor.memoryOverhead: '1536'
      pyspark:
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '1'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/pyspark
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.task.cpus: '1'
          spark.yarn.executor.memoryOverhead: '512'
      pyspark_train:
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '4'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/pyspark
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.task.cpus: '4'
          spark.yarn.executor.memoryOverhead: '6144'
      training_pipeline:
        cmd_args:
          cv-jobs: '125'
          final-trees: '100'
          input: hdfs://analytics-hadoop/user/pytest/mjolnir/marker-folds_medium
          output: /home/pytest/training_size/marker-folds_medium
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        mjolnir_utility: training_pipeline
        mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
            /home/pytest/training_size: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          driver-memory: 3G
          executor-cores: '4'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/spark-submit
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.dynamicAllocation.executorIdleTimeout: 180s
          spark.dynamicAllocation.maxExecutors: '130'
          spark.task.cpus: '4'
          spark.yarn.executor.memoryOverhead: '2048'
    wikis:
    - itwiki
    - ptwiki
    - frwiki
    - ruwiki
  small:
    commands:
      data_pipeline:
        cmd_args:
          input: hdfs://analytics-hadoop/wmf/data/discovery/query_clicks/daily/year=*/month=*/day=*
          min-sessions: '10'
          output-dir: hdfs://analytics-hadoop/user/pytest/mjolnir/marker
          samples-per-wiki: '35000000'
          search-cluster: codfw
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        mjolnir_utility: data_pipeline
        mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          dir_not_exist: !!set
            /mnt/hdfs/user/pytest/mjolnir/marker: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '1'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/spark-submit
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.task.cpus: '1'
          spark.yarn.executor.memoryOverhead: '512'
      make_folds:
        cmd_args:
          input: hdfs://analytics-hadoop/user/pytest/mjolnir/marker
          max-executors: '50'
          num-folds: '5'
          num-workers: '1'
          output-dir: hdfs://analytics-hadoop/user/pytest/mjolnir/marker-folds_small
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        mjolnir_utility: make_folds
        mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '1'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/spark-submit
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.dynamicAllocation.maxExecutors: '100'
          spark.locality.wait: '0'
          spark.task.cpus: '1'
          spark.yarn.executor.memoryOverhead: '1024'
      pyspark:
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '1'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/pyspark
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.task.cpus: '1'
          spark.yarn.executor.memoryOverhead: '512'
      pyspark_train:
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          executor-cores: '4'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/pyspark
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.task.cpus: '4'
          spark.yarn.executor.memoryOverhead: '6144'
      training_pipeline:
        cmd_args:
          cv-jobs: '125'
          final-trees: '500'
          input: hdfs://analytics-hadoop/user/pytest/mjolnir/marker-folds_small
          output: /home/pytest/training_size/marker-folds_small
        environment:
          HOME: /home/pytest
          PYSPARK_PYTHON: venv/bin/python
          SPARK_CONF_DIR: /etc/spark2/conf
          SPARK_HOME: /usr/lib/spark2
          USER: pytest
        mjolnir_utility: training_pipeline
        mjolnir_utility_path: /srv/mjolnir/venv/bin/mjolnir-utilities.py
        paths:
          dir_exist: !!set
            /etc/spark2/conf: null
            /home/pytest/training_size: null
          file_exist: !!set
            /srv/mjolnir/mjolnir_venv.zip: null
            /srv/mjolnir/venv/bin/mjolnir-utilities.py: null
            /usr/lib/spark2/bin/spark-submit: null
            venv/bin/python: null
        spark_args:
          archives: /srv/mjolnir/mjolnir_venv.zip#venv
          driver-memory: 3G
          executor-cores: '4'
          executor-memory: 2G
          files: /usr/lib/libhdfs.so.0.0.0
          master: yarn
          packages: ml.dmlc:xgboost4j-spark:0.8-wmf-1,org.wikimedia.search:mjolnir:0.3,org.apache.spark:spark-streaming-kafka-0-8_2.11:2.1.2
          repositories: https://archiva.wikimedia.org/repository/releases,https://archiva.wikimedia.org/repository/snapshots,https://archiva.wikimedia.org/repository/mirrored
        spark_command: /usr/lib/spark2/bin/spark-submit
        spark_conf:
          spark.driver.extraJavaOptions: -Dhttp.proxyHost=webproxy.eqiad.wmnet -Dhttp.proxyPort=8080
            -Dhttps.proxyHost=webproxy.eqiad.wmnet -Dhttps.proxyPort=8080
          spark.dynamicAllocation.executorIdleTimeout: 180s
          spark.dynamicAllocation.maxExecutors: '130'
          spark.task.cpus: '4'
          spark.yarn.executor.memoryOverhead: '1024'
    wikis:
    - svwiki
    - fawiki
    - idwiki
    - viwiki
    - nowiki
    - hewiki
    - kowiki
    - fiwiki
    - jawiki
    - arwiki
    - nlwiki
    - zhwiki
    - plwiki
